[Info] Loading train data...
[Info] Loading test data...
[Info] parameters: Namespace(batch_size=8, coefficient=0.14, d_inner_hid=1024, d_k=1024, d_model=1024, d_rnn=128, d_v=896, data='../data/Yelp/', device=device(type='cuda'), dropout=0.66203, epoch=30, ita=0.037, log='log.txt', lr=9.9e-05, n_dis=12, n_head=12, n_layers=2, smooth=0.05998)
[Info] Number of parameters: 169092975
[ Epoch 1 ]
 (Training)    P@5: 0.01006, R@5: 0.02118, P@10: 0.00854, R@10: 0.03481, P@20: 0.00696, R@20: 0.05669, elapse:2.935 min                                                     
 (Test)        P@5: 0.02673, R@5: 0.02615, P@10: 0.02322, R@10: 0.04513, P@20: 0.01926, R@20: 0.07354, elapse:0.983 min                                                     
[ Epoch 2 ]
 (Training)    P@5: 0.01738, R@5: 0.03734, P@10: 0.01477, R@10: 0.06397, P@20: 0.01188, R@20: 0.10146, elapse:2.906 min                                                     
 (Test)        P@5: 0.03104, R@5: 0.03034, P@10: 0.02688, R@10: 0.05266, P@20: 0.02215, R@20: 0.08588, elapse:0.987 min                                                     
[ Epoch 3 ]
 (Training)    P@5: 0.02299, R@5: 0.05119, P@10: 0.01893, R@10: 0.08394, P@20: 0.01520, R@20: 0.13348, elapse:2.927 min                                                     
 (Test)        P@5: 0.03301, R@5: 0.03259, P@10: 0.02817, R@10: 0.05518, P@20: 0.02327, R@20: 0.09035, elapse:0.986 min                                                     
[ Epoch 4 ]
 (Training)    P@5: 0.02997, R@5: 0.06861, P@10: 0.02434, R@10: 0.11005, P@20: 0.01911, R@20: 0.17111, elapse:2.914 min                                                     
 (Test)        P@5: 0.03475, R@5: 0.03403, P@10: 0.02967, R@10: 0.05823, P@20: 0.02422, R@20: 0.09404, elapse:0.991 min                                                     
[ Epoch 5 ]
 (Training)    P@5: 0.03811, R@5: 0.08949, P@10: 0.03014, R@10: 0.13931, P@20: 0.02310, R@20: 0.20814, elapse:2.910 min                                                     
 (Test)        P@5: 0.03592, R@5: 0.03527, P@10: 0.03018, R@10: 0.05900, P@20: 0.02483, R@20: 0.09607, elapse:0.987 min                                                     
[ Epoch 6 ]
 (Training)    P@5: 0.04628, R@5: 0.10775, P@10: 0.03556, R@10: 0.16247, P@20: 0.02694, R@20: 0.24128, elapse:2.919 min                                                     
 (Test)        P@5: 0.03542, R@5: 0.03493, P@10: 0.03031, R@10: 0.05942, P@20: 0.02487, R@20: 0.09663, elapse:0.989 min                                                     
[ Epoch 7 ]
 (Training)    P@5: 0.05362, R@5: 0.12423, P@10: 0.04060, R@10: 0.18353, P@20: 0.03023, R@20: 0.26838, elapse:2.915 min                                                     
 (Test)        P@5: 0.03676, R@5: 0.03605, P@10: 0.03101, R@10: 0.06071, P@20: 0.02526, R@20: 0.09753, elapse:0.985 min                                                     
[ Epoch 8 ]
 (Training)    P@5: 0.06093, R@5: 0.13960, P@10: 0.04534, R@10: 0.20342, P@20: 0.03328, R@20: 0.29240, elapse:2.927 min                                                     
 (Test)        P@5: 0.03690, R@5: 0.03635, P@10: 0.03121, R@10: 0.06098, P@20: 0.02547, R@20: 0.09856, elapse:0.989 min                                                     
[ Epoch 9 ]
 (Training)    P@5: 0.06684, R@5: 0.15160, P@10: 0.04898, R@10: 0.21739, P@20: 0.03558, R@20: 0.30831, elapse:2.930 min                                                     
 (Test)        P@5: 0.03711, R@5: 0.03651, P@10: 0.03131, R@10: 0.06137, P@20: 0.02546, R@20: 0.09831, elapse:0.988 min                                                     
[ Epoch 10 ]
 (Training)    P@5: 0.07248, R@5: 0.16342, P@10: 0.05238, R@10: 0.23019, P@20: 0.03757, R@20: 0.32335, elapse:2.920 min                                                     
 (Test)        P@5: 0.03756, R@5: 0.03677, P@10: 0.03130, R@10: 0.06126, P@20: 0.02569, R@20: 0.09946, elapse:0.990 min                                                     
[ Epoch 11 ]
 (Training)    P@5: 0.08922, R@5: 0.19838, P@10: 0.06344, R@10: 0.27403, P@20: 0.04459, R@20: 0.37761, elapse:2.929 min                                                     
 (Test)        P@5: 0.03804, R@5: 0.03704, P@10: 0.03174, R@10: 0.06196, P@20: 0.02603, R@20: 0.10039, elapse:0.993 min                                                     
[ Epoch 12 ]
 (Training)    P@5: 0.09523, R@5: 0.20956, P@10: 0.06700, R@10: 0.28735, P@20: 0.04660, R@20: 0.39118, elapse:2.937 min                                                     
 (Test)        P@5: 0.03803, R@5: 0.03733, P@10: 0.03204, R@10: 0.06256, P@20: 0.02624, R@20: 0.10138, elapse:0.988 min                                                     
[ Epoch 13 ]
 (Training)    P@5: 0.10044, R@5: 0.21982, P@10: 0.06980, R@10: 0.29682, P@20: 0.04808, R@20: 0.40158, elapse:2.948 min                                                     
 (Test)        P@5: 0.03814, R@5: 0.03724, P@10: 0.03216, R@10: 0.06253, P@20: 0.02645, R@20: 0.10190, elapse:0.985 min                                                     
[ Epoch 14 ]
 (Training)    P@5: 0.10409, R@5: 0.22698, P@10: 0.07207, R@10: 0.30629, P@20: 0.04919, R@20: 0.40801, elapse:2.923 min                                                     
 (Test)        P@5: 0.03843, R@5: 0.03758, P@10: 0.03223, R@10: 0.06305, P@20: 0.02631, R@20: 0.10136, elapse:0.988 min                                                     
[ Epoch 15 ]
 (Training)    P@5: 0.10753, R@5: 0.23295, P@10: 0.07397, R@10: 0.31184, P@20: 0.05025, R@20: 0.41462, elapse:2.934 min                                                     
 (Test)        P@5: 0.03840, R@5: 0.03739, P@10: 0.03253, R@10: 0.06336, P@20: 0.02639, R@20: 0.10166, elapse:0.990 min                                                     
[ Epoch 16 ]
 (Training)    P@5: 0.11059, R@5: 0.23810, P@10: 0.07599, R@10: 0.31852, P@20: 0.05144, R@20: 0.42243, elapse:2.951 min                                                     
 (Test)        P@5: 0.03827, R@5: 0.03743, P@10: 0.03225, R@10: 0.06289, P@20: 0.02647, R@20: 0.10184, elapse:0.992 min                                                     
[ Epoch 17 ]
 (Training)    P@5: 0.11397, R@5: 0.24439, P@10: 0.07779, R@10: 0.32445, P@20: 0.05215, R@20: 0.42582, elapse:2.941 min                                                     
 (Test)        P@5: 0.03850, R@5: 0.03760, P@10: 0.03242, R@10: 0.06324, P@20: 0.02653, R@20: 0.10220, elapse:0.989 min                                                     
[ Epoch 18 ]
 (Training)    P@5: 0.11706, R@5: 0.24945, P@10: 0.07926, R@10: 0.32978, P@20: 0.05292, R@20: 0.43102, elapse:2.928 min                                                     
 (Test)        P@5: 0.03855, R@5: 0.03763, P@10: 0.03269, R@10: 0.06384, P@20: 0.02661, R@20: 0.10230, elapse:0.991 min                                                     
[ Epoch 19 ]
 (Training)    P@5: 0.11990, R@5: 0.25552, P@10: 0.08071, R@10: 0.33509, P@20: 0.05359, R@20: 0.43449, elapse:2.943 min                                                     
 (Test)        P@5: 0.03818, R@5: 0.03740, P@10: 0.03257, R@10: 0.06364, P@20: 0.02657, R@20: 0.10230, elapse:0.988 min                                                     
[ Epoch 20 ]
 (Training)    P@5: 0.12302, R@5: 0.26203, P@10: 0.08265, R@10: 0.34219, P@20: 0.05434, R@20: 0.44001, elapse:2.946 min                                                     
 (Test)        P@5: 0.03852, R@5: 0.03765, P@10: 0.03274, R@10: 0.06358, P@20: 0.02665, R@20: 0.10229, elapse:0.987 min                                                     
[ Epoch 21 ]
 (Training)    P@5: 0.13510, R@5: 0.28482, P@10: 0.09039, R@10: 0.37047, P@20: 0.05948, R@20: 0.47757, elapse:2.962 min                                                     
 (Test)        P@5: 0.03891, R@5: 0.03802, P@10: 0.03282, R@10: 0.06400, P@20: 0.02664, R@20: 0.10232, elapse:0.988 min                                                     
[ Epoch 22 ]
 (Training)    P@5: 0.13860, R@5: 0.29205, P@10: 0.09209, R@10: 0.37660, P@20: 0.06028, R@20: 0.48252, elapse:2.944 min                                                     
 (Test)        P@5: 0.03884, R@5: 0.03797, P@10: 0.03282, R@10: 0.06406, P@20: 0.02667, R@20: 0.10229, elapse:0.983 min                                                     
[ Epoch 23 ]
 (Training)    P@5: 0.14097, R@5: 0.29684, P@10: 0.09373, R@10: 0.38211, P@20: 0.06133, R@20: 0.48990, elapse:2.946 min                                                     
 (Test)        P@5: 0.03890, R@5: 0.03802, P@10: 0.03291, R@10: 0.06430, P@20: 0.02661, R@20: 0.10226, elapse:0.986 min                                                     
[ Epoch 24 ]
 (Training)    P@5: 0.14378, R@5: 0.30181, P@10: 0.09544, R@10: 0.38889, P@20: 0.06200, R@20: 0.49452, elapse:2.954 min                                                     
 (Test)        P@5: 0.03839, R@5: 0.03750, P@10: 0.03278, R@10: 0.06402, P@20: 0.02675, R@20: 0.10290, elapse:0.990 min                                                     
[ Epoch 25 ]
 (Training)    P@5: 0.14555, R@5: 0.30508, P@10: 0.09635, R@10: 0.39296, P@20: 0.06255, R@20: 0.49825, elapse:2.941 min                                                     
 (Test)        P@5: 0.03886, R@5: 0.03800, P@10: 0.03282, R@10: 0.06419, P@20: 0.02680, R@20: 0.10294, elapse:0.991 min                                                     
[ Epoch 26 ]
 (Training)    P@5: 0.14774, R@5: 0.30997, P@10: 0.09776, R@10: 0.39786, P@20: 0.06318, R@20: 0.50250, elapse:2.944 min                                                     
 (Test)        P@5: 0.03893, R@5: 0.03797, P@10: 0.03282, R@10: 0.06399, P@20: 0.02659, R@20: 0.10232, elapse:0.991 min                                                     
[ Epoch 27 ]
 (Training)    P@5: 0.15017, R@5: 0.31459, P@10: 0.09899, R@10: 0.40178, P@20: 0.06370, R@20: 0.50647, elapse:2.951 min                                                     
 (Test)        P@5: 0.03870, R@5: 0.03781, P@10: 0.03297, R@10: 0.06453, P@20: 0.02679, R@20: 0.10286, elapse:0.992 min                                                     
[ Epoch 28 ]
 (Training)    P@5: 0.15240, R@5: 0.31886, P@10: 0.10041, R@10: 0.40723, P@20: 0.06438, R@20: 0.51036, elapse:2.961 min                                                     
 (Test)        P@5: 0.03915, R@5: 0.03828, P@10: 0.03295, R@10: 0.06436, P@20: 0.02678, R@20: 0.10294, elapse:0.989 min                                                     
[ Epoch 29 ]
 (Training)    P@5: 0.15409, R@5: 0.32213, P@10: 0.10117, R@10: 0.40983, P@20: 0.06485, R@20: 0.51421, elapse:2.942 min                                                     
 (Test)        P@5: 0.03886, R@5: 0.03791, P@10: 0.03296, R@10: 0.06445, P@20: 0.02667, R@20: 0.10251, elapse:0.992 min                                                     
[ Epoch 30 ]
 (Training)    P@5: 0.15607, R@5: 0.32646, P@10: 0.10240, R@10: 0.41525, P@20: 0.06555, R@20: 0.51953, elapse:2.945 min                                                     
 (Test)        P@5: 0.03878, R@5: 0.03779, P@10: 0.03315, R@10: 0.06463, P@20: 0.02677, R@20: 0.10304, elapse:0.987 min