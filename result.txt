[Info] parameters: Namespace(batch_size=8, coefficient=0.14, d_inner_hid=1024, d_k=1024, d_model=1024, d_rnn=128, d_v=896, data='../data/Yelp/', device=device(type='cuda'), dropout=0.66203, epoch=30, ita=0.037, log='log.txt', lr=9.9e-05, n_dis=8, n_head=12, n_layers=2, smooth=0.05998)
[Info] Number of parameters: 163274003
[ Epoch 1 ]
  - (Validation) :   0%|          | 0/3505 [00:00<?, ?it/s] (Training)    P@5: 0.01044, R@5: 0.02227, P@10: 0.00873, R@10: 0.03652, P@20: 0.00712, R@20: 0.05869, elapse:2.582 min
  - (Training)   :   0%|          | 0/3505 [00:00<?, ?it/s] (Test)        P@5: 0.02682, R@5: 0.02643, P@10: 0.02326, R@10: 0.04543, P@20: 0.01914, R@20: 0.07416, elapse:0.952 min
[ Epoch 2 ]
  - (Validation) :   0%|          | 0/3505 [00:00<?, ?it/s] (Training)    P@5: 0.01786, R@5: 0.03882, P@10: 0.01510, R@10: 0.06598, P@20: 0.01215, R@20: 0.10490, elapse:2.587 min
  - (Training)   :   0%|          | 0/3505 [00:00<?, ?it/s] (Test)        P@5: 0.03142, R@5: 0.03102, P@10: 0.02642, R@10: 0.05197, P@20: 0.02189, R@20: 0.08495, elapse:0.952 min
[ Epoch 3 ]
  - (Validation) :   0%|          | 0/3505 [00:00<?, ?it/s] (Training)    P@5: 0.02400, R@5: 0.05422, P@10: 0.01975, R@10: 0.08909, P@20: 0.01591, R@20: 0.14198, elapse:2.588 min
  - (Training)   :   0%|          | 0/3505 [00:00<?, ?it/s] (Test)        P@5: 0.03323, R@5: 0.03261, P@10: 0.02825, R@10: 0.05552, P@20: 0.02319, R@20: 0.08986, elapse:0.956 min
[ Epoch 4 ]
  - (Validation) :   0%|          | 0/3505 [00:00<?, ?it/s] (Training)    P@5: 0.03133, R@5: 0.07236, P@10: 0.02550, R@10: 0.11774, P@20: 0.01983, R@20: 0.17993, elapse:2.579 min
  - (Training)   :   0%|          | 0/3505 [00:00<?, ?it/s] (Test)        P@5: 0.03450, R@5: 0.03367, P@10: 0.02941, R@10: 0.05739, P@20: 0.02394, R@20: 0.09252, elapse:0.956 min
[ Epoch 5 ]
  - (Validation) :   0%|          | 0/3505 [00:00<?, ?it/s] (Training)    P@5: 0.03923, R@5: 0.09216, P@10: 0.03083, R@10: 0.14206, P@20: 0.02411, R@20: 0.21914, elapse:2.590 min
  - (Training)   :   0%|          | 0/3505 [00:00<?, ?it/s] (Test)        P@5: 0.03511, R@5: 0.03425, P@10: 0.03020, R@10: 0.05884, P@20: 0.02437, R@20: 0.09418, elapse:0.960 min
[ Epoch 6 ]
  - (Validation) :   0%|          | 0/3505 [00:00<?, ?it/s] (Training)    P@5: 0.04715, R@5: 0.11062, P@10: 0.03673, R@10: 0.16934, P@20: 0.02793, R@20: 0.25224, elapse:2.588 min
  - (Training)   :   0%|          | 0/3505 [00:00<?, ?it/s] (Test)        P@5: 0.03603, R@5: 0.03500, P@10: 0.03045, R@10: 0.05939, P@20: 0.02483, R@20: 0.09567, elapse:0.958 min
[ Epoch 7 ]
  - (Validation) :   0%|          | 0/3505 [00:00<?, ?it/s] (Training)    P@5: 0.05535, R@5: 0.12874, P@10: 0.04209, R@10: 0.19165, P@20: 0.03162, R@20: 0.28241, elapse:2.588 min
  - (Training)   :   0%|          | 0/3505 [00:00<?, ?it/s] (Test)        P@5: 0.03582, R@5: 0.03501, P@10: 0.03055, R@10: 0.05973, P@20: 0.02498, R@20: 0.09678, elapse:0.958 min
[ Epoch 8 ]
  - (Validation) :   0%|          | 0/3505 [00:00<?, ?it/s] (Training)    P@5: 0.06298, R@5: 0.14675, P@10: 0.04666, R@10: 0.21168, P@20: 0.03435, R@20: 0.30465, elapse:2.600 min
  - (Training)   :   0%|          | 0/3505 [00:00<?, ?it/s] (Test)        P@5: 0.03675, R@5: 0.03594, P@10: 0.03103, R@10: 0.06032, P@20: 0.02533, R@20: 0.09779, elapse:0.953 min
[ Epoch 9 ]
  - (Validation) :   0%|          | 0/3505 [00:00<?, ?it/s] (Training)    P@5: 0.06967, R@5: 0.16013, P@10: 0.05080, R@10: 0.22808, P@20: 0.03681, R@20: 0.32215, elapse:2.604 min
  - (Training)   :   0%|          | 0/3505 [00:00<?, ?it/s] (Test)        P@5: 0.03743, R@5: 0.03648, P@10: 0.03155, R@10: 0.06131, P@20: 0.02550, R@20: 0.09855, elapse:0.962 min
[ Epoch 10 ]
  - (Validation) :   0%|          | 0/3505 [00:00<?, ?it/s] (Training)    P@5: 0.07576, R@5: 0.17189, P@10: 0.05447, R@10: 0.24218, P@20: 0.03905, R@20: 0.33745, elapse:2.589 min
  - (Training)   :   0%|          | 0/3505 [00:00<?, ?it/s] (Test)        P@5: 0.03719, R@5: 0.03634, P@10: 0.03142, R@10: 0.06119, P@20: 0.02570, R@20: 0.09910, elapse:0.959 min
[ Epoch 11 ]
  - (Validation) :   0%|          | 0/3505 [00:00<?, ?it/s] (Training)    P@5: 0.09374, R@5: 0.20979, P@10: 0.06629, R@10: 0.28918, P@20: 0.04661, R@20: 0.39732, elapse:2.599 min
  - (Training)   :   0%|          | 0/3505 [00:00<?, ?it/s] (Test)        P@5: 0.03782, R@5: 0.03672, P@10: 0.03206, R@10: 0.06221, P@20: 0.02591, R@20: 0.09969, elapse:0.957 min
[ Epoch 12 ]
  - (Validation) :   0%|          | 0/3505 [00:00<?, ?it/s] (Training)    P@5: 0.09999, R@5: 0.22206, P@10: 0.07032, R@10: 0.30412, P@20: 0.04887, R@20: 0.41247, elapse:2.599 min
  - (Training)   :   0%|          | 0/3505 [00:00<?, ?it/s] (Test)        P@5: 0.03746, R@5:git 0.03651, P@10: 0.03201, R@10: 0.06237, P@20: 0.02605, R@20: 0.10015, elapse:0.957 min
[ Epoch 13 ]
  - (Validation) :   0%|          | 0/3505 [00:00<?, ?it/s] (Training)    P@5: 0.10497, R@5: 0.23111, P@10: 0.07278, R@10: 0.31132, P@20: 0.05040, R@20: 0.42239, elapse:2.606 min
  - (Training)   :   0%|          | 0/3505 [00:00<?, ?it/s] (Test)        P@5: 0.03785, R@5: 0.03690, P@10: 0.03211, R@10: 0.06240, P@20: 0.02609, R@20: 0.10034, elapse:0.952 min
[ Epoch 14 ]
  - (Validation) :   0%|          | 0/3505 [00:00<?, ?it/s] (Training)    P@5: 0.10867, R@5: 0.23860, P@10: 0.07509, R@10: 0.32071, P@20: 0.05140, R@20: 0.42695, elapse:2.610 min
  - (Training)   :   0%|          | 0/3505 [00:00<?, ?it/s] (Test)        P@5: 0.03853, R@5: 0.03748, P@10: 0.03240, R@10: 0.06294, P@20: 0.02625, R@20: 0.10086, elapse:0.957 min
[ Epoch 15 ]
  - (Validation) :   0%|          | 0/3505 [00:00<?, ?it/s] (Training)    P@5: 0.11325, R@5: 0.24653, P@10: 0.07773, R@10: 0.32872, P@20: 0.05277, R@20: 0.43602, elapse:2.610 min
  - (Training)   :   0%|          | 0/3505 [00:00<?, ?it/s] (Test)        P@5: 0.03809, R@5: 0.03712, P@10: 0.03254, R@10: 0.06313, P@20: 0.02619, R@20: 0.10056, elapse:0.955 min
[ Epoch 16 ]
  - (Validation) :   0%|          | 0/3505 [00:00<?, ?it/s] (Training)    P@5: 0.11604, R@5: 0.25195, P@10: 0.07934, R@10: 0.33519, P@20: 0.05365, R@20: 0.44248, elapse:2.612 min
  - (Training)   :   0%|          | 0/3505 [00:00<?, ?it/s] (Test)        P@5: 0.03832, R@5: 0.03726, P@10: 0.03237, R@10: 0.06301, P@20: 0.02623, R@20: 0.10071, elapse:0.952 min
[ Epoch 17 ]
  - (Validation) :   0%|          | 0/3505 [00:00<?, ?it/s] (Training)    P@5: 0.11969, R@5: 0.25901, P@10: 0.08154, R@10: 0.34253, P@20: 0.05454, R@20: 0.44645, elapse:2.606 min
  - (Training)   :   0%|          | 0/3505 [00:00<?, ?it/s] (Test)        P@5: 0.03821, R@5: 0.03724, P@10: 0.03229, R@10: 0.06264, P@20: 0.02624, R@20: 0.10064, elapse:0.953 min
[ Epoch 18 ]
  - (Validation) :   0%|          | 0/3505 [00:00<?, ?it/s] (Training)    P@5: 0.12363, R@5: 0.26650, P@10: 0.08325, R@10: 0.34857, P@20: 0.05568, R@20: 0.45537, elapse:2.613 min
  - (Training)   :   0%|          | 0/3505 [00:00<?, ?it/s] (Test)        P@5: 0.03820, R@5: 0.03719, P@10: 0.03238, R@10: 0.06289, P@20: 0.02647, R@20: 0.10143, elapse:0.953 min
[ Epoch 19 ]
  - (Validation) :   0%|          | 0/3505 [00:00<?, ?it/s] (Training)    P@5: 0.12673, R@5: 0.27196, P@10: 0.08548, R@10: 0.35615, P@20: 0.05643, R@20: 0.46028, elapse:2.610 min
  - (Training)   :   0%|          | 0/3505 [00:00<?, ?it/s] (Test)        P@5: 0.03815, R@5: 0.03718, P@10: 0.03228, R@10: 0.06294, P@20: 0.02626, R@20: 0.10066, elapse:0.949 min
[ Epoch 20 ]
  - (Validation) :   0%|          | 0/3505 [00:00<?, ?it/s] (Training)    P@5: 0.12947, R@5: 0.27573, P@10: 0.08724, R@10: 0.36160, P@20: 0.05766, R@20: 0.46792, elapse:2.608 min
  - (Training)   :   0%|          | 0/3505 [00:00<?, ?it/s] (Test)        P@5: 0.03849, R@5: 0.03755, P@10: 0.03258, R@10: 0.06346, P@20: 0.02647, R@20: 0.10149, elapse:0.959 min
[ Epoch 21 ]
  - (Validation) :   0%|          | 0/3505 [00:00<?, ?it/s] (Training)    P@5: 0.14356, R@5: 0.30402, P@10: 0.09535, R@10: 0.39234, P@20: 0.06252, R@20: 0.50220, elapse:2.612 min
  - (Training)   :   0%|          | 0/3505 [00:00<?, ?it/s] (Test)        P@5: 0.03874, R@5: 0.03782, P@10: 0.03287, R@10: 0.06392, P@20: 0.02652, R@20: 0.10169, elapse:0.958 min
[ Epoch 22 ]
  - (Validation) :   0%|          | 0/3505 [00:00<?, ?it/s] (Training)    P@5: 0.14634, R@5: 0.30971, P@10: 0.09758, R@10: 0.40008, P@20: 0.06373, R@20: 0.51112, elapse:2.608 min
  - (Training)   :   0%|          | 0/3505 [00:00<?, ?it/s] (Test)        P@5: 0.03908, R@5: 0.03812, P@10: 0.03274, R@10: 0.06375, P@20: 0.02647, R@20: 0.10156, elapse:0.957 min
[ Epoch 23 ]
  - (Validation) :   0%|          | 0/3505 [00:00<?, ?it/s] (Training)    P@5: 0.14959, R@5: 0.31612, P@10: 0.09954, R@10: 0.40758, P@20: 0.06469, R@20: 0.51728, elapse:2.616 min
  - (Training)   :   0%|          | 0/3505 [00:00<?, ?it/s] (Test)        P@5: 0.03863, R@5: 0.03759, P@10: 0.03281, R@10: 0.06384, P@20: 0.02652, R@20: 0.10158, elapse:0.959 min
[ Epoch 24 ]
  - (Validation) :   0%|          | 0/3505 [00:00<?, ?it/s] (Training)    P@5: 0.15241, R@5: 0.32161, P@10: 0.10105, R@10: 0.41289, P@20: 0.06547, R@20: 0.52286, elapse:2.616 min
  - (Training)   :   0%|          | 0/3505 [00:00<?, ?it/s] (Test)        P@5: 0.03853, R@5: 0.03747, P@10: 0.03266, R@10: 0.06354, P@20: 0.02640, R@20: 0.10118, elapse:0.958 min
[ Epoch 25 ]
  - (Validation) :   0%|          | 0/3505 [00:00<?, ?it/s] (Training)    P@5: 0.15512, R@5: 0.32708, P@10: 0.10224, R@10: 0.41819, P@20: 0.06606, R@20: 0.52659, elapse:2.621 min
  - (Training)   :   0%|          | 0/3505 [00:00<?, ?it/s] (Test)        P@5: 0.03840, R@5: 0.03733, P@10: 0.03274, R@10: 0.06388, P@20: 0.02652, R@20: 0.10154, elapse:0.956 min
[ Epoch 26 ]
  - (Validation) :   0%|          | 0/3505 [00:00<?, ?it/s] (Training)    P@5: 0.15756, R@5: 0.33218, P@10: 0.10370, R@10: 0.42319, P@20: 0.06686, R@20: 0.53236, elapse:2.622 min
  - (Training)   :   0%|          | 0/3505 [00:00<?, ?it/s] (Test)        P@5: 0.03861, R@5: 0.03750, P@10: 0.03267, R@10: 0.06353, P@20: 0.02655, R@20: 0.10179, elapse:0.956 min
[ Epoch 27 ]
  - (Validation) :   0%|          | 0/3505 [00:00<?, ?it/s] (Training)    P@5: 0.15958, R@5: 0.33533, P@10: 0.10497, R@10: 0.42816, P@20: 0.06739, R@20: 0.53609, elapse:2.619 min
  - (Training)   :   0%|          | 0/3505 [00:00<?, ?it/s] (Test)        P@5: 0.03879, R@5: 0.03766, P@10: 0.03262, R@10: 0.06355, P@20: 0.02652, R@20: 0.10170, elapse:0.961 min
[ Epoch 28 ]
  - (Validation) :   0%|          | 0/3505 [00:00<?, ?it/s] (Training)    P@5: 0.16214, R@5: 0.34014, P@10: 0.10666, R@10: 0.43372, P@20: 0.06816, R@20: 0.54086, elapse:2.626 min
  - (Training)   :   0%|          | 0/3505 [00:00<?, ?it/s] (Test)        P@5: 0.03862, R@5: 0.03745, P@10: 0.03281, R@10: 0.06359, P@20: 0.02660, R@20: 0.10192, elapse:0.956 min
[ Epoch 29 ]
  - (Validation) :   0%|          | 0/3505 [00:00<?, ?it/s] (Training)    P@5: 0.16497, R@5: 0.34607, P@10: 0.10760, R@10: 0.43765, P@20: 0.06889, R@20: 0.54738, elapse:2.618 min
  - (Training)   :   0%|          | 0/3505 [00:00<?, ?it/s] (Test)        P@5: 0.03823, R@5: 0.03706, P@10: 0.03238, R@10: 0.06286, P@20: 0.02636, R@20: 0.10099, elapse:0.958 min
[ Epoch 30 ]
  - (Validation) :   0%|          | 0/3505 [00:00<?, ?it/s] (Training)    P@5: 0.16742, R@5: 0.35219, P@10: 0.10933, R@10: 0.44468, P@20: 0.06964, R@20: 0.55320, elapse:2.623 min
[I 2021-04-13 21:06:28,514] Trial 17 finished with value: 0.03907553946736349 and parameters: {}. Best is trial 17 with value: 0.03907553946736349.
